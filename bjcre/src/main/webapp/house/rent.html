<!DOCTYPE html>
<html slick-uniqueid="3">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript">
        var _stat_cst = new Date().getTime();
    </script>
    <meta name="description" content="发布出租">

    <meta name="format-detection" content="telephone=no">
    <title>发布出租</title>
    <link rel="stylesheet" rev="stylesheet" href="../css/Broker_Register.css" type="text/css">
    <script type="text/javascript" src="../js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="../js/ajaxfileupload.js"></script>
    <script type="text/javascript" src="../js/common/common.js"></script>
    <script type="text/javascript" src="../js/Broker_Register.js"></script>
    <script type="text/javascript">
    </script>
    <!--<script src="./manager_register_files/st" async=""></script>-->
</head>
<body>

<div id="container">
    <div class="container clearfix">
        <div class="register">
            <h1>发布</h1>

            <!--<form action="" method="POST">-->
                <table width="100%" border="0" cellpadding="0" cellspacing="0">
                    <tbody>
                    <tr id="tr_main_business">
                        <th>类型：</th>
                        <td class="business"colspan="2">
                            <input type="radio" id="infoType_1" name="infoType" value="1"
                                   checked="checked"><label>出租</option>&nbsp;&nbsp;&nbsp;
                            <input type="radio" id="infoType_2" name="infoType" value="2"><label>求租</option>&nbsp;&nbsp;&nbsp;
                            <input type="radio" id="infoType_3" name="infoType" value="3"><label>出售</option>&nbsp;&nbsp;&nbsp;
                            <input type="radio" id="infoType_4" name="infoType" value="4"><label>求购</option>&nbsp;&nbsp;&nbsp;
                        </td>
                        <!--<td class="" id="business_tips" style="display:none">-->
                        <!--<div class="check_error" id="tip_business_error">-->
                        <!--</div>-->
                        <!--<div class="check_ok" id="tip_business_ok">&nbsp;</div>-->
                        <!--</td>-->
                    </tr>
                    <tr>
                        <th>标题：</th>
                        <td class="td_input">
                            <input type="text" id="title" class="input_text " name="title" value="" maxlength="">
                        </td>
                        <td class="td_tips" id="mobiletip">
                            <div class="tip_mobile_1"></div>
                        </td>
                    </tr>
                    <tr>
                        <th>楼盘名称：</th>
                        <td class="td_input">
                            <input type="text" id="houseName" class="input_text " name="houseName" value="" maxlength="">
                        </td>
                        <td class="td_tips" id="passwordtip">
                            <div class=""></div>
                        </td>
                    </tr>
                    <tr>
                        <th>所在区域：</th>
                        <td colspan="2">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tbody>
                                <tr>
                                    <td class="td_area">
                                        <div class="select_content area_content clearfix">
                                            <a id="select_area" href="javascript:void(0);" class="select_boxer">
                                                <span id="selectareatext" class="select_txt">请选择区域</span>
                                                <input type="hidden" name="selectareaid" id="selectareaid" value="0">
                                                <span class="arrow"></span>
                                            </a>
                                            <ul id="searchlistarea" class="searchlist h241" style="display:none">
                                            </ul>
                                        </div>
                                        <div class="select_content block_content clearfix">
                                            <a id="select_block" href="javascript:void(0);" class="select_boxer">
                                                <span id="selectblocktext" class="select_txt">请选择板块</span>
                                                <input type="hidden" name="selectblockid" id="selectblockid" value="0">
                                                <span class="arrow"></span>
                                            </a>
                                            <ul id="searchlistblock" class="searchlist h241" style="display:none">
                                            </ul>
                                        </div>
                                    </td>
                                    <td id="areatip" class="td_area_tips">
                                        <div class="check_ok tip_area_1" style="display: none;">&nbsp;</div>
                                        <div class="check_error tip_area_3" style="display: none;">请选择区域。</div>
                                        <div class="check_error tip_area_4" style="display: none;">请选择版块。</div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </td>
                        <!--<td class="td_input">-->
                            <!--<input type="text" id="areaId" class="input_text" name="areaId" value=""/>-->
                            <!--<div id="area_panel" class="area_panel" style="display: block">&nbsp;</div>-->
                        <!--</td>-->
                        <!--<td class="td_tips" id="pwdtip">-->
                            <!--<div class="check_ok tip_pwd_1" style="display:none">&nbsp;</div>-->
                        <!--</td>-->
                    </tr>
                    <tr>
                        <th>地址：</th>
                        <td class="td_input">
                            <input type="text" id="address" class="input_text" name="address" value="" >
                        </td>
                        <td class="td_tips" id="nametip">
                            <div class="check_ok tip_name_2" style="display:none">&nbsp;</div>
                            <div class="check_error tip_name_3" style="display:none">

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>类型：</th>
                        <td colspan="2">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tbody>
                                <tr>
                                    <td class="td_input">
                                        <div class="relative" style="z-index:9">
                                            <select id="houseType">
                                                <option value="1">写字楼</option>
                                                <option value="2">商务中心</option>
                                                <option value="3">商住公寓</option>
                                                <option value="4">商铺</option>
                                                <option value="5">厂房</option>
                                                <option value="6">仓库</option>
                                                <option value="7">养老地产</option>
                                                <option value="8">其他</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td id="companytip" class="td_tips">
                                        <div id="companytip1" class="check_ok" style="display:none">&nbsp;</div>
                                        <div id="companytip2" class="check_error" style="display:none;">请在列表中选择您的所属公司。
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <th>注册公司：</th>
                        <td colspan="2">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tbody>
                                <tr>
                                    <td class="td_input">
                                        <div class="relative" style="z-index:9">
                                            <input type="radio" id="isRegisterCompany_yes" name="isRegisterCompany" value="0"
                                                   checked="checked"><label>可以</option>&nbsp;&nbsp;&nbsp;
                                            <input type="radio" id="isRegisterCompany_no" name="isRegisterCompany" value="1"><label>不可以</option>&nbsp;&nbsp;&nbsp;

                                        </div>
                                    </td>
                                    <td id="companytip" class="td_tips">
                                        <div id="companytip1" class="check_ok" style="display:none">&nbsp;</div>
                                        <div id="companytip2" class="check_error" style="display:none;">请在列表中选择您的所属公司。
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <th>日租金：</th>
                        <td class="td_input">
                            <input type="text" id="dayRent" class="input_text" name="dayRent" value=""/>
                        </td>
                        <td class="td_tips" id="dayRenttip">
                            <div class="check_ok tip_pwd_1" style="display:none">&nbsp;</div>
                        </td>
                    </tr>
                    <tr>
                        <th>总租金：</th>
                        <td class="td_input">
                            <input type="text" id="totalRent" class="input_text" name="totalRent" value=""/>
                        </td>
                        <td class="td_tips" id="totalRenttip">
                            <div class="check_ok tip_pwd_1" style="display:none">&nbsp;</div>
                        </td>
                    </tr>
                    <!--<tr>-->
                        <!--<th>价格：</th>-->
                        <!--<td class="td_input">-->
                            <!--<input type="text" id="price" class="input_text" name="price" value="" maxlength="20">-->
                        <!--</td>-->
                        <!--<td class="td_tips" id="pricetip">-->
                            <!--<div class="relative" style="z-index:15">-->
                                <!--<input type="radio" id="price_type_1" name="price_type" value="1"-->
                                       <!--checked="checked"><label>元/㎡/天</option>&nbsp;&nbsp;&nbsp;-->
                                <!--<input type="radio" id="price_type_2" name="price_type" value="2"><label>元/月</option>&nbsp;&nbsp;&nbsp;-->

                            <!--</div>-->
                            <!--<div class="check_ok tip_name_2" style="display:none">&nbsp;</div>-->
                            <!--<div class="check_error tip_name_3" style="display:none">-->
                                <!--请填写您的真实姓名(请勿使用空格)。-->
                            <!--</div>-->
                        <!--</td>-->
                    <!--</tr>-->
                    <tr>
                        <th>面积：</th>
                        <td class="td_input">
                            <input type="text" id="acreage" class="input_text" name="acreage" value="" maxlength="20">
                        </td>
                        <td class="td_tips" id="acreagetip">
                            <div class="check_ok tip_name_2" style="display:none">&nbsp;</div>
                            <div class="check_error tip_name_3" style="display:none">

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>联系人：</th>
                        <td class="td_input">
                            <input type="text" id="connector" class="input_text" name="connector" value="" maxlength="20">
                        </td>
                        <td class="td_tips" id="connectortip">
                            <div class="check_ok tip_name_2" style="display:none">&nbsp;</div>
                            <div class="check_error tip_name_3" style="display:none">

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>联系电话：</th>
                        <td class="td_input">
                            <input type="text" id="connectorMobile" class="input_text" name="connectorMobile" value="" maxlength="20">
                        </td>
                        <td class="td_tips" id="connectorMobiletip">
                            <div class="check_ok tip_name_2" style="display:none">&nbsp;</div>
                            <div class="check_error tip_name_3" style="display:none">

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>说明：</th>
                        <td class="td_input" colspan="2">
                            <textarea id="description" name="description" style="width: 400px;" rows="10"> </textarea>
                        </td>
                    </tr>
                    <tr >
                        <th>上传图片&nbsp;</th>
                        <td colspan="2">
                            <div id="fileUpLoad" class="manage">
                                添附文件
                                <!-- 自定义 <input type="file"/> -->
                                <input type="file" id="btnFile" name="btnFile" onchange="txtFoo.value=this.value;com.company.project.services.newCase.fileUpLoad()" hidden="hidden" />
                                <input type="text" id="txtFoo" readonly="readonly" style="width: 300px" />
                                <button onclick="btnFile.click()" style="height: 25px;">选择文件</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>&nbsp;</th>
                        <td colspan="2">
                            <input type="hidden" name="action" value="register">
                            <button id="publish" class="submit_but" title="马上发布">马上发布</button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            <!--</form>-->
        </div>
        <!--<div class="side_tips">中介门店店长注册，请拨打：<br><span>400-620-9008（9:00-18:00）</span></div>-->
    </div>
    <script type="text/javascript">
        if (!window.com) {
            window.com = {};
        }
        if (!window.com.company) {
            window.com.company= {};
        }
        if (!window.com.company.project) {
            window.com.company.project= {};
        }
        if (!window.com.company.project.services) {
            window.com.company.project.services = {};
        }
        if (!window.com.company.project.services.newCase) {
            window.com.company.project.services.newCase = {};
        }

        //生成随机guid数(参考网上)
        com.company.project.services.newCase.getGuidGenerator = function() {
            var S4 = function() {
                return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
            };
            return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
        };

        //上传文件
        com.company.project.services.newCase.fileUpLoad = function(){
            var fileName = $("#btnFile").val();//文件名
            fileName = fileName.split("\\");
            fileName = fileName[fileName.length-1];
            var guid = com.company.project.services.newCase.getGuidGenerator();//唯一标识guid
            var data = {guid:guid};
            jQuery.ajaxSettings.traditional = true;
            $.ajaxFileUpload({
                url:"/resource/images",
                secureuri : false,//安全协议
                fileElementId:'btnFile',//id
                type : 'POST',
//                dataType : 'json',
                data:data,
                async : false,
                error : function(data,status,e) {
//                    alert('Operate Failed!'+data);
                },
                success : function(json) {
                    if (json.resultFlag==false){
//                        alert(json.resultMessage);
                    }else{
//                        alert('文件上传成功!');
                        var next = $("#fileUpLoad").html();
                        $("#fileUpLoad").html("<div id='"+guid+"'>"+"<img width='133' height='100' src='/upload/"+guid+"."+fileName+"' />"+fileName
                            +"   <a href='#fileUpLoad' onclick='com.company.project.services.newCase.filedelete("+"\""+guid+"\""+","+"\""+fileName+"\""+")'>删除</a>"+"<br/></div>");
                        $("#fileUpLoad").append(next);
                    }
                }
            });
        };

        //文件删除
        com.company.project.services.newCase.filedelete = function(guid,fileName){
            jQuery.ajaxSettings.traditional = true;
            var data = {guid:guid,fileName:fileName};
            $.ajax({
                url:"/resource/images/"+guid,
                type : 'DELETE',
//                dataType : 'json',
                data:data,
                async : false,
                error : function() {
//                    alert('Operate Failed!');
                },
                success : function(json) {
                    if (json.resultFlag==false){
//                        alert(json.resultMessage);
                    }else{
//                        alert('删除成功!');
                        $("#"+guid).remove();
                    }
                }
            });
        };

    </script>

        <script type="text/javascript">
        jQuery("#selectareaid").val(0);
        jQuery("#selectblockid").val(0);
        jQuery("#storeid").val(0);

//        $("#select_area").click(function(){
//            $("#searchlistarea").show();
//        });

        $("#publish").click(function(){
            $.post("/resource/houses",{
                infoType: $("input[name='infoType']").val(),
                title: $("#title").val(),
                houseName: $("#houseName").val(),
                areaId: $("#selectareaid").val(),
                blockId: $("#selectblockid").val(),
                address: $("#address").val(),
                houseType: $("#houseType").val(),
                isRegisterCompany: $("input[name='isRegisterCompany']").val(),
                dayRent: $("#dayRent").val(),
                totalRent: $("#totalRent").val(),
                acreage: $("#acreage").val(),
                connector: $("#connector").val(),
                connectorMobile: $("#connectorMobile").val(),
                description: $("#description").val(),
                image: $("#fileUpLoad img").attr("src"),
                infoType: $("#infoType").val()
            },function(result){
                console.log(result);
                if (result.status != 200){
                    return;
                }

                window.location.href = "/house/rent_info.html?id="+result.data.id;
            });
        });
    </script>
</div>




</body>
</html>